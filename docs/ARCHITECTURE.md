# ğŸ—ï¸ Arquitectura del Sistema PA vs SV

Este documento describe la arquitectura tÃ©cnica, flujos de datos y comportamiento de cada capa del sistema.

---

## ğŸ“ Diagrama de Arquitectura General

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   USUARIOS                                       â”‚
â”‚                    ğŸ‘¤ Analistas    ğŸ‘¤ Gerentes    ğŸ‘¤ Supervisores                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚ HTTPS
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸŒ CAPA FRONTEND                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                         NAVEGADOR WEB                                       â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚   HTML5     â”‚   â”‚ Tailwind CSSâ”‚   â”‚  ECharts    â”‚   â”‚ JavaScript  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  Templates  â”‚   â”‚   (CDN)     â”‚   â”‚   (CDN)     â”‚   â”‚   ES6+      â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚   â”‚                        PÃGINAS                                        â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  Dashboard   â”‚  â”‚    Upload    â”‚  â”‚       Admin Django       â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  /dashboard/ â”‚  â”‚ /dashboard/  â”‚  â”‚        /admin/           â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚              â”‚  â”‚   upload/    â”‚  â”‚                          â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚ â€¢ 6 Tabs     â”‚  â”‚ â€¢ Drag&Drop  â”‚  â”‚ â€¢ GestiÃ³n de Tenants    â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚ â€¢ 6 Filtros  â”‚  â”‚ â€¢ Progress   â”‚  â”‚ â€¢ GestiÃ³n de Jobs       â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚ â€¢ 6 KPIs     â”‚  â”‚ â€¢ ValidaciÃ³n â”‚  â”‚ â€¢ GestiÃ³n de Usuarios   â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â”‚ â€¢ GrÃ¡ficos   â”‚  â”‚              â”‚  â”‚                          â”‚   â”‚ â”‚ â”‚
â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚ HTTP/JSON
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸ”· CAPA API (Django)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      URL ROUTING (urls.py)                                  â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚   /admin/          â†’  Django Admin                                          â”‚ â”‚
â”‚  â”‚   /api/v1/         â†’  API REST (jobs)                                       â”‚ â”‚
â”‚  â”‚   /dashboard/      â†’  Dashboard Views                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                         APPS DJANGO                                         â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚    TENANTS      â”‚  â”‚      JOBS       â”‚  â”‚       DASHBOARD         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                 â”‚  â”‚                 â”‚  â”‚                         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Tenant        â”‚  â”‚ â€¢ AnalysisJob   â”‚  â”‚ â€¢ DashboardView         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Membership    â”‚  â”‚ â€¢ Artifact      â”‚  â”‚ â€¢ UploadView            â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Roles         â”‚  â”‚ â€¢ Snapshot      â”‚  â”‚ â€¢ MetricsAPIView        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                 â”‚  â”‚                 â”‚  â”‚ â€¢ PeriodsAPIView        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ Aislamiento     â”‚  â”‚ Procesamiento   â”‚  â”‚ â€¢ CompareAPIView        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ Multi-tenant    â”‚  â”‚ de archivos     â”‚  â”‚ â€¢ DetailsAPIView        â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    CAPA DE LÃ“GICA DE NEGOCIO                                â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚ DataProcessor   â”‚  â”‚AnalysisEngine   â”‚  â”‚    ExcelExporter        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚    (Polars)     â”‚  â”‚    (Polars)     â”‚  â”‚      (Polars)           â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                 â”‚  â”‚                 â”‚  â”‚                         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Leer Excel    â”‚  â”‚ â€¢ Cruzar datos  â”‚  â”‚ â€¢ Generar Excel         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Limpiar datos â”‚  â”‚ â€¢ Calcular diff â”‚  â”‚ â€¢ Formatear hojas       â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Normalizar    â”‚  â”‚ â€¢ Clasificar    â”‚  â”‚ â€¢ Estilos               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚ â€¢ Validar       â”‚  â”‚   estados       â”‚  â”‚                         â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚ ORM
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ’¾ CAPA DE DATOS                                       â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚     BASE DE DATOS            â”‚    â”‚        SISTEMA DE ARCHIVOS           â”‚ â”‚
â”‚   â”‚     (SQLite/PostgreSQL)      â”‚    â”‚             (Media)                  â”‚ â”‚
â”‚   â”‚                              â”‚    â”‚                                      â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚   /media/tenants/                    â”‚ â”‚
â”‚   â”‚   â”‚      Tenant        â”‚    â”‚    â”‚   â””â”€â”€ {tenant_slug}/                 â”‚ â”‚
â”‚   â”‚   â”‚ â€¢ id (UUID)        â”‚    â”‚    â”‚       â””â”€â”€ jobs/                      â”‚ â”‚
â”‚   â”‚   â”‚ â€¢ name             â”‚    â”‚    â”‚           â””â”€â”€ {job_id}/              â”‚ â”‚
â”‚   â”‚   â”‚ â€¢ slug             â”‚    â”‚    â”‚               â”œâ”€â”€ inputs/            â”‚ â”‚
â”‚   â”‚   â”‚ â€¢ is_active        â”‚    â”‚    â”‚               â”‚   â”œâ”€â”€ pa.xlsx        â”‚ â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚               â”‚   â””â”€â”€ sv.xlsx        â”‚ â”‚
â”‚   â”‚            â”‚                â”‚    â”‚               â””â”€â”€ artifacts/         â”‚ â”‚
â”‚   â”‚            â–¼                â”‚    â”‚                   â””â”€â”€ resultado.xlsx â”‚ â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚                                      â”‚ â”‚
â”‚   â”‚   â”‚   AnalysisJob      â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚   â”‚   â”‚ â€¢ id (UUID)        â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ tenant_id (FK)   â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ period_month     â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ status           â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ input_pa (File)  â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ input_sv (File)  â”‚    â”‚                                             â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                             â”‚
â”‚   â”‚            â”‚                â”‚                                             â”‚
â”‚   â”‚            â–¼                â”‚                                             â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                                             â”‚
â”‚   â”‚   â”‚     Artifact       â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ id (UUID)        â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ job_id (FK)      â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ kind (excel/log) â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ file (File)      â”‚    â”‚                                             â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                             â”‚
â”‚   â”‚            â”‚                â”‚                                             â”‚
â”‚   â”‚            â–¼                â”‚                                             â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                                             â”‚
â”‚   â”‚   â”‚  AnalysisSnapshot  â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ id (UUID)        â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ tenant_id (FK)   â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ job_id (FK)      â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ period_month     â”‚    â”‚                                             â”‚
â”‚   â”‚   â”‚ â€¢ metrics (JSON)   â”‚    â”‚                                             â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flujos de Datos

### 1. Flujo de Upload y Procesamiento

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FLUJO: UPLOAD Y PROCESAMIENTO DE ARCHIVOS                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     USUARIO                FRONTEND               API                   BACKEND
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  1. Selecciona      â”‚                    â”‚                        â”‚
        â”‚     archivos PA/SV  â”‚                    â”‚                        â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  2. Valida formato â”‚                        â”‚
        â”‚                      â”‚     (.xlsx/.csv)   â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  3. POST /api/v1/  â”‚                        â”‚
        â”‚                      â”‚     jobs/          â”‚                        â”‚
        â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
        â”‚                      â”‚  FormData:         â”‚                        â”‚
        â”‚                      â”‚  - file_pa         â”‚                        â”‚
        â”‚                      â”‚  - file_sv         â”‚                        â”‚
        â”‚                      â”‚  - period          â”‚                        â”‚
        â”‚                      â”‚  - tenant          â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  4. Crear AnalysisJob  â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     status=QUEUED      â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  5. Guardar archivos   â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     /media/tenants/... â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  6. Response       â”‚                        â”‚
        â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                      â”‚  {job_id, status}  â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  7. Procesar datos     â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     (sÃ­ncrono)         â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚                    â”‚        â”‚     PROCESAMIENTO             â”‚
        â”‚                      â”‚                    â”‚        â”‚                               â”‚
        â”‚                      â”‚                    â”‚        â”‚  a. DataProcessor.load()      â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Leer Excel con Polars   â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Detectar encoding       â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Normalizar columnas     â”‚
        â”‚                      â”‚                    â”‚        â”‚                               â”‚
        â”‚                      â”‚                    â”‚        â”‚  b. AnalysisEngine.analyze()  â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Cruzar PA con SV        â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Calcular diferencias    â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Asignar estados         â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Agregar mÃ©tricas        â”‚
        â”‚                      â”‚                    â”‚        â”‚                               â”‚
        â”‚                      â”‚                    â”‚        â”‚  c. ExcelExporter.export()    â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Generar Excel resultado â”‚
        â”‚                      â”‚                    â”‚        â”‚     - Crear hojas:            â”‚
        â”‚                      â”‚                    â”‚        â”‚       â€¢ Resumen               â”‚
        â”‚                      â”‚                    â”‚        â”‚       â€¢ PA vs SV              â”‚
        â”‚                      â”‚                    â”‚        â”‚       â€¢ Por Estado            â”‚
        â”‚                      â”‚                    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  8. Crear Artifact     â”‚
        â”‚                      â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚                      â”‚                    â”‚     (Excel resultado)  â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  9. Crear Snapshot     â”‚
        â”‚                      â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚                      â”‚                    â”‚     (mÃ©tricas JSON)    â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  10. Update Job        â”‚
        â”‚                      â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚                      â”‚                    â”‚      status=SUCCEEDED  â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  11. Poll status   â”‚                        â”‚
        â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
        â”‚                      â”‚  GET /jobs/{id}/   â”‚                        â”‚
        â”‚                      â”‚      status/       â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  12. Response      â”‚                        â”‚
        â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                      â”‚  {status:succeeded}â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  13. Redirigir a     â”‚                    â”‚                        â”‚
        â”‚      Dashboard       â”‚                    â”‚                        â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â–¼                      â–¼                    â–¼                        â–¼
```

---

### 2. Flujo de VisualizaciÃ³n del Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FLUJO: VISUALIZACIÃ“N DEL DASHBOARD                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     USUARIO                FRONTEND               API                   DATABASE
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  1. Navegar a       â”‚                    â”‚                        â”‚
        â”‚     /dashboard/     â”‚                    â”‚                        â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  2. GET /dashboard â”‚                        â”‚
        â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  3. Query Tenant       â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  4. Query Periods      â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     SELECT DISTINCT    â”‚
        â”‚                      â”‚                    â”‚     period_month       â”‚
        â”‚                      â”‚                    â”‚     FROM AnalysisJob   â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  5. HTML Response  â”‚                        â”‚
        â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  6. Render pÃ¡gina   â”‚                    â”‚                        â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  7. JS: Fetch API  â”‚                        â”‚
        â”‚                      â”‚  GET /dashboard/   â”‚                        â”‚
        â”‚                      â”‚  api/metrics/      â”‚                        â”‚
        â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
        â”‚                      â”‚  ?tenant=default   â”‚                        â”‚
        â”‚                      â”‚  &period=2025-11   â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  8. Query Snapshot     â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     SELECT metrics     â”‚
        â”‚                      â”‚                    â”‚     FROM Snapshot      â”‚
        â”‚                      â”‚                    â”‚     WHERE tenant=X     â”‚
        â”‚                      â”‚                    â”‚     AND period=Y       â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚                    â”‚        â”‚  Si no hay Snapshot:          â”‚
        â”‚                      â”‚                    â”‚        â”‚  - Leer Parquet/Excel         â”‚
        â”‚                      â”‚                    â”‚        â”‚  - Calcular mÃ©tricas          â”‚
        â”‚                      â”‚                    â”‚        â”‚  - Generar agregados          â”‚
        â”‚                      â”‚                    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  9. JSON Response  â”‚                        â”‚
        â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                      â”‚  {                 â”‚                        â”‚
        â”‚                      â”‚    total_pa: 14708,â”‚                        â”‚
        â”‚                      â”‚    total_sv: 13237,â”‚                        â”‚
        â”‚                      â”‚    diferencia:1470,â”‚                        â”‚
        â”‚                      â”‚    cobertura: 90%, â”‚                        â”‚
        â”‚                      â”‚    by_estado: [...],â”‚                       â”‚
        â”‚                      â”‚    by_cliente:[...],â”‚                       â”‚
        â”‚                      â”‚    by_zona: [...], â”‚                        â”‚
        â”‚                      â”‚    filtros: {...}  â”‚                        â”‚
        â”‚                      â”‚  }                 â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  10. Renderizar    â”‚                        â”‚
        â”‚                      â”‚      grÃ¡ficos      â”‚                        â”‚
        â”‚                      â”‚   â€¢ ECharts.init() â”‚                        â”‚
        â”‚                      â”‚   â€¢ setOption()    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  11. Ver dashboard   â”‚                    â”‚                        â”‚
        â”‚      interactivo     â”‚                    â”‚                        â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â–¼                      â–¼                    â–¼                        â–¼
```

---

### 3. Flujo de Descarga de Excel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FLUJO: DESCARGA DE EXCEL                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

     USUARIO                FRONTEND               API                   STORAGE
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  1. Click botÃ³n     â”‚                    â”‚                        â”‚
        â”‚     "ğŸ“¥ Excel"      â”‚                    â”‚                        â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  2. GET /api/v1/   â”‚                        â”‚
        â”‚                      â”‚     jobs/latest/   â”‚                        â”‚
        â”‚                      â”‚     download/      â”‚                        â”‚
        â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
        â”‚                      â”‚  ?tenant=default   â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  3. Query Ãºltimo Job   â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     SELECT * FROM Job  â”‚
        â”‚                      â”‚                    â”‚     WHERE status=      â”‚
        â”‚                      â”‚                    â”‚       'succeeded'      â”‚
        â”‚                      â”‚                    â”‚     ORDER BY           â”‚
        â”‚                      â”‚                    â”‚       created_at DESC  â”‚
        â”‚                      â”‚                    â”‚     LIMIT 1            â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  4. Query Artifact     â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     SELECT file FROM   â”‚
        â”‚                      â”‚                    â”‚     Artifact WHERE     â”‚
        â”‚                      â”‚                    â”‚     job_id=X AND       â”‚
        â”‚                      â”‚                    â”‚     kind='excel'       â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚  5. Leer archivo       â”‚
        â”‚                      â”‚                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                      â”‚                    â”‚     /media/tenants/    â”‚
        â”‚                      â”‚                    â”‚     default/jobs/      â”‚
        â”‚                      â”‚                    â”‚     {id}/artifacts/    â”‚
        â”‚                      â”‚                    â”‚     resultado.xlsx     â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚                      â”‚  6. FileResponse   â”‚                        â”‚
        â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
        â”‚                      â”‚  Headers:          â”‚                        â”‚
        â”‚                      â”‚  Content-Type:     â”‚                        â”‚
        â”‚                      â”‚    application/    â”‚                        â”‚
        â”‚                      â”‚    vnd.openxml...  â”‚                        â”‚
        â”‚                      â”‚  Content-Disp:     â”‚                        â”‚
        â”‚                      â”‚    attachment;     â”‚                        â”‚
        â”‚                      â”‚    filename=       â”‚                        â”‚
        â”‚                      â”‚    "PA_vs_SV_      â”‚                        â”‚
        â”‚                      â”‚     2025-11.xlsx"  â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â”‚  7. Descargar       â”‚                    â”‚                        â”‚
        â”‚     archivo         â”‚                    â”‚                        â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                        â”‚
        â”‚                      â”‚                    â”‚                        â”‚
        â–¼                      â–¼                    â–¼                        â–¼
```

---

## ğŸ”€ Comportamiento por Capa

### 1. Capa Frontend

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CAPA FRONTEND - COMPORTAMIENTO                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“„ main.html (Dashboard Principal)                                              â”‚
â”‚                                                                                  â”‚
â”‚  ESTRUCTURA:                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  HEADER                                                                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  TÃ­tulo  â”‚  â”‚ Periodo      â”‚  â”‚Compararâ”‚  â”‚ Subir  â”‚  â”‚   Excel    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚          â”‚  â”‚ [Dropdown â–¼] â”‚  â”‚   ğŸ“Š   â”‚  â”‚   ğŸ“¤   â”‚  â”‚     ğŸ“¥     â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  FILTROS GLOBALES                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚MacroZona â”‚ â”‚   Zona   â”‚ â”‚ CompaÃ±Ã­a â”‚ â”‚  Grupo   â”‚ â”‚  Sector  â”‚ â”‚Ger. â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  [â–¼]     â”‚ â”‚   [â–¼]    â”‚ â”‚   [â–¼]    â”‚ â”‚   [â–¼]    â”‚ â”‚   [â–¼]    â”‚ â”‚ [â–¼] â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  NAVEGACIÃ“N (TABS)                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Resumen  â”‚ â”‚Por Clienteâ”‚ â”‚Por Unidadâ”‚ â”‚Por Serv. â”‚ â”‚ GrÃ¡ficos â”‚ â”‚Det. â”‚ â”‚ â”‚
â”‚  â”‚  â”‚    ğŸ“ˆ    â”‚ â”‚    ğŸ‘¥    â”‚ â”‚    ğŸ¢    â”‚ â”‚    ğŸ”§    â”‚ â”‚    ğŸ“Š    â”‚ â”‚  ğŸ“‹ â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  CONTENIDO (varÃ­a segÃºn tab activo)                                         â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  Tab "Resumen":                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                    â”‚ â”‚
â”‚  â”‚  â”‚  PA  â”‚ â”‚  SV  â”‚ â”‚ Diff â”‚ â”‚ Cob% â”‚ â”‚ Dif% â”‚ â”‚ Totalâ”‚  â† KPIs            â”‚ â”‚
â”‚  â”‚  â”‚14,708â”‚ â”‚13,237â”‚ â”‚1,470 â”‚ â”‚ 90%  â”‚ â”‚ 11%  â”‚ â”‚5,576 â”‚                    â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚ â”‚
â”‚  â”‚  â”‚  ğŸ“Š Por Estado      â”‚  â”‚  ğŸ† Top 10 Clientes â”‚  â† GrÃ¡ficos             â”‚ â”‚
â”‚  â”‚  â”‚     (Barras)        â”‚  â”‚      (Barras H)     â”‚                         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚ â”‚
â”‚  â”‚  â”‚  ğŸŒ Por Zona        â”‚  â”‚  ğŸ—ºï¸ Por MacroZona  â”‚                         â”‚ â”‚
â”‚  â”‚  â”‚     (Barras)        â”‚  â”‚      (Donut)        â”‚                         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  COMPORTAMIENTO JAVASCRIPT:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. DOMContentLoaded â†’ fetchMetrics()                                       â”‚ â”‚
â”‚  â”‚  2. fetchMetrics() â†’ GET /dashboard/api/metrics/?tenant=X&period=Y          â”‚ â”‚
â”‚  â”‚  3. Response â†’ updateKPIs(data) + renderCharts(data)                        â”‚ â”‚
â”‚  â”‚  4. Tab click â†’ showTab(tabId) + chart.resize()                             â”‚ â”‚
â”‚  â”‚  5. Filter change â†’ applyFilters() (frontend filtering)                     â”‚ â”‚
â”‚  â”‚  6. Period change â†’ fetchMetrics() con nuevo periodo                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“„ upload.html (PÃ¡gina de Carga)                                                â”‚
â”‚                                                                                  â”‚
â”‚  COMPONENTES:                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚                     DROP ZONE - PA                                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚     ğŸ“ Arrastra aquÃ­ el archivo de Personal Asignado                â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                    o haz click para seleccionar                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚     [archivo_pa.xlsx âœ“]                                             â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚                     DROP ZONE - SV                                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚     ğŸ“ Arrastra aquÃ­ el archivo de Servicio Vivo                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                    o haz click para seleccionar                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                                      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚     [archivo_sv.xlsx âœ“]                                             â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  Periodo: [Noviembre â–¼] [2025 â–¼]    [ğŸš€ Procesar Archivos]         â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  BARRA DE PROGRESO                                                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  45%           â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  "Procesando datos..."                                               â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  EVENTOS:                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â€¢ dragover  â†’ e.preventDefault() + addClass('drag-over')                   â”‚ â”‚
â”‚  â”‚  â€¢ dragleave â†’ removeClass('drag-over')                                     â”‚ â”‚
â”‚  â”‚  â€¢ drop      â†’ e.preventDefault() + handleFile(e.dataTransfer.files[0])     â”‚ â”‚
â”‚  â”‚  â€¢ click     â†’ input[type=file].click()                                     â”‚ â”‚
â”‚  â”‚  â€¢ submit    â†’ POST /api/v1/jobs/ con FormData                              â”‚ â”‚
â”‚  â”‚  â€¢ polling   â†’ setInterval(checkStatus, 1000)                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. Capa API (Django)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CAPA API - COMPORTAMIENTO                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ JOBS APP                                                                     â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  JobCreateView (POST /api/v1/jobs/)                                         â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  def post(self, request):                                                   â”‚ â”‚
â”‚  â”‚      1. Validar archivos (file_pa, file_sv)                                â”‚ â”‚
â”‚  â”‚      2. Validar tenant y periodo                                           â”‚ â”‚
â”‚  â”‚      3. Crear AnalysisJob(status=QUEUED)                                   â”‚ â”‚
â”‚  â”‚      4. Guardar archivos en /media/                                        â”‚ â”‚
â”‚  â”‚      5. job.status = RUNNING                                               â”‚ â”‚
â”‚  â”‚      6. Llamar run_analysis(job)                                           â”‚ â”‚
â”‚  â”‚         â”œâ”€â”€ DataProcessor.load_files()                                     â”‚ â”‚
â”‚  â”‚         â”œâ”€â”€ AnalysisEngine.analyze()                                       â”‚ â”‚
â”‚  â”‚         â”œâ”€â”€ ExcelExporter.export()                                         â”‚ â”‚
â”‚  â”‚         â””â”€â”€ Crear Artifact + Snapshot                                      â”‚ â”‚
â”‚  â”‚      7. job.status = SUCCEEDED (o FAILED si error)                         â”‚ â”‚
â”‚  â”‚      8. Return {job_id, status}                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  JobStatusView (GET /api/v1/jobs/<id>/status/)                              â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  def get(self, request, job_id):                                           â”‚ â”‚
â”‚  â”‚      1. Query AnalysisJob by id                                            â”‚ â”‚
â”‚  â”‚      2. Return {status, error_message?, artifact_url?}                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  JobLatestDownloadView (GET /api/v1/jobs/latest/download/)                  â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  def get(self, request):                                                   â”‚ â”‚
â”‚  â”‚      1. Get tenant from query params                                       â”‚ â”‚
â”‚  â”‚      2. Query Ãºltimo Job exitoso del tenant                                â”‚ â”‚
â”‚  â”‚      3. Query Artifact tipo 'excel'                                        â”‚ â”‚
â”‚  â”‚      4. Generar filename: PA_vs_SV_{YYYY-MM}.xlsx                          â”‚ â”‚
â”‚  â”‚      5. Return FileResponse con headers apropiados                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ DASHBOARD APP                                                                â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  DashboardView (GET /dashboard/)                                            â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  def get(self, request):                                                   â”‚ â”‚
â”‚  â”‚      1. Resolver tenant (query param o default)                            â”‚ â”‚
â”‚  â”‚      2. Query perÃ­odos disponibles                                         â”‚ â”‚
â”‚  â”‚      3. Render template 'dashboard/main.html' con contexto                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  MetricsAPIView (GET /dashboard/api/metrics/)                               â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  def get(self, request):                                                   â”‚ â”‚
â”‚  â”‚      1. Parsear tenant y period de query params                            â”‚ â”‚
â”‚  â”‚      2. Buscar Snapshot existente                                          â”‚ â”‚
â”‚  â”‚      3. Si no existe, generar mÃ©tricas desde Job:                          â”‚ â”‚
â”‚  â”‚         â”œâ”€â”€ Leer Excel resultado con Polars                                â”‚ â”‚
â”‚  â”‚         â”œâ”€â”€ Calcular agregados (total_pa, total_sv, etc.)                  â”‚ â”‚
â”‚  â”‚         â”œâ”€â”€ Agrupar by_estado, by_cliente, by_zona, etc.                   â”‚ â”‚
â”‚  â”‚         â””â”€â”€ Extraer valores Ãºnicos para filtros                            â”‚ â”‚
â”‚  â”‚      4. Return JSON con todas las mÃ©tricas                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  _generate_metrics_from_job() - LÃ“GICA PRINCIPAL                            â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  Preferencia de datos SV sobre PA:                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚  zona = pl.coalesce([                                                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚      pl.col("Zona_SV"),           # Primero SV                       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚      pl.col("Zona_PA"),           # Fallback PA                      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚      pl.lit("Sin Zona")           # Default                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  ])                                                                   â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  Agregaciones generadas:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ by_estado     â†’ [{estado, pa, sv, count}]                              â”‚ â”‚
â”‚  â”‚  â€¢ by_cliente    â†’ [{nombre, grupo, pa, sv, diff, cob%, estado}]          â”‚ â”‚
â”‚  â”‚  â€¢ by_zona       â†’ [{zona, pa, sv}]                                       â”‚ â”‚
â”‚  â”‚  â€¢ by_macrozona  â†’ [{macrozona, total}]                                   â”‚ â”‚
â”‚  â”‚  â€¢ by_unidad     â†’ [{unidad, pa, sv}]                                     â”‚ â”‚
â”‚  â”‚  â€¢ by_servicio   â†’ [{servicio, pa, sv}]                                   â”‚ â”‚
â”‚  â”‚  â€¢ by_grupo      â†’ [{grupo, pa, sv}]                                      â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  Filtros disponibles:                                                      â”‚ â”‚
â”‚  â”‚  â€¢ macrozona  â†’ valores Ãºnicos de Macrozona_SV                            â”‚ â”‚
â”‚  â”‚  â€¢ zona       â†’ valores Ãºnicos de Zona combinada                          â”‚ â”‚
â”‚  â”‚  â€¢ compania   â†’ valores Ãºnicos de CompaÃ±Ã­a_PA/SV                          â”‚ â”‚
â”‚  â”‚  â€¢ grupo      â†’ valores Ãºnicos de Nombre_Grupo                            â”‚ â”‚
â”‚  â”‚  â€¢ sector     â†’ valores Ãºnicos de Sector_PA/SV                            â”‚ â”‚
â”‚  â”‚  â€¢ gerente    â†’ valores Ãºnicos de Gerencia_PA/SV                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  CompareAPIView (GET /dashboard/api/compare/)                               â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  def get(self, request):                                                   â”‚ â”‚
â”‚  â”‚      1. Obtener period_a y period_b de query params                        â”‚ â”‚
â”‚  â”‚      2. Generar mÃ©tricas para ambos perÃ­odos                               â”‚ â”‚
â”‚  â”‚      3. Calcular variaciones (delta, %)                                    â”‚ â”‚
â”‚  â”‚      4. Return {period_a: {...}, period_b: {...}, variation: {...}}        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. Capa Base de Datos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CAPA BASE DE DATOS - ESQUEMA                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š MODELO ENTIDAD-RELACIÃ“N                                                      â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚     Tenant      â”‚                                                            â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                                            â”‚
â”‚  â”‚ PK id (UUID)    â”‚                                                            â”‚
â”‚  â”‚    name         â”‚                                                            â”‚
â”‚  â”‚    slug (unique)â”‚                                                            â”‚
â”‚  â”‚    is_active    â”‚                                                            â”‚
â”‚  â”‚    created_at   â”‚                                                            â”‚
â”‚  â”‚    updated_at   â”‚                                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚           â”‚                                                                      â”‚
â”‚           â”‚ 1:N                                                                  â”‚
â”‚           â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚  AnalysisJob    â”‚         â”‚     Artifact    â”‚                               â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                               â”‚
â”‚  â”‚ PK id (UUID)    â”‚ 1:N     â”‚ PK id (UUID)    â”‚                               â”‚
â”‚  â”‚ FK tenant_id    â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ FK job_id       â”‚                               â”‚
â”‚  â”‚    period_month â”‚         â”‚    kind (enum)  â”‚                               â”‚
â”‚  â”‚    status(enum) â”‚         â”‚    file (path)  â”‚                               â”‚
â”‚  â”‚    input_pa     â”‚         â”‚    created_at   â”‚                               â”‚
â”‚  â”‚    input_sv     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  â”‚    error_messageâ”‚                                                            â”‚
â”‚  â”‚    created_at   â”‚                                                            â”‚
â”‚  â”‚    updated_at   â”‚                                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚           â”‚                                                                      â”‚
â”‚           â”‚ 1:1                                                                  â”‚
â”‚           â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚AnalysisSnapshot â”‚                                                            â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                                            â”‚
â”‚  â”‚ PK id (UUID)    â”‚                                                            â”‚
â”‚  â”‚ FK tenant_id    â”‚                                                            â”‚
â”‚  â”‚ FK job_id (1:1) â”‚                                                            â”‚
â”‚  â”‚    period_month â”‚                                                            â”‚
â”‚  â”‚    metrics(JSON)â”‚  â† MÃ©tricas pre-calculadas                                â”‚
â”‚  â”‚    created_at   â”‚                                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚   Membership    â”‚         â”‚      User       â”‚                               â”‚
â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚  (Django Auth)  â”‚                               â”‚
â”‚  â”‚ PK id (UUID)    â”‚ N:1     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                               â”‚
â”‚  â”‚ FK user_id      â”‚â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ PK id           â”‚                               â”‚
â”‚  â”‚ FK tenant_id    â”‚         â”‚    username     â”‚                               â”‚
â”‚  â”‚    role (enum)  â”‚         â”‚    email        â”‚                               â”‚
â”‚  â”‚    created_at   â”‚         â”‚    ...          â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ ENUMS Y CHOICES                                                              â”‚
â”‚                                                                                  â”‚
â”‚  JobStatus:                    ArtifactKind:           MembershipRole:          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ QUEUED           â”‚       â”‚ â€¢ EXCEL        â”‚       â”‚ â€¢ OWNER        â”‚       â”‚
â”‚  â”‚ â€¢ RUNNING          â”‚       â”‚ â€¢ PARQUET      â”‚       â”‚ â€¢ ADMIN        â”‚       â”‚
â”‚  â”‚ â€¢ SUCCEEDED        â”‚       â”‚ â€¢ LOG          â”‚       â”‚ â€¢ ANALYST      â”‚       â”‚
â”‚  â”‚ â€¢ FAILED           â”‚       â”‚                â”‚       â”‚ â€¢ VIEWER       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” ÃNDICES OPTIMIZADOS                                                          â”‚
â”‚                                                                                  â”‚
â”‚  AnalysisJob:                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â€¢ INDEX (tenant_id, period_month)  â†’ Queries dashboard por periodo        â”‚ â”‚
â”‚  â”‚  â€¢ INDEX (tenant_id, status)        â†’ Filtrar jobs por estado              â”‚ â”‚
â”‚  â”‚  â€¢ ORDER BY created_at DESC         â†’ Obtener Ãºltimo job                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â”‚  AnalysisSnapshot:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â€¢ UNIQUE (tenant_id, period_month) â†’ Un snapshot por periodo/tenant       â”‚ â”‚
â”‚  â”‚  â€¢ INDEX (job_id)                   â†’ Buscar por job                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ ESTRUCTURA JSON - metrics (AnalysisSnapshot)                                 â”‚
â”‚                                                                                  â”‚
â”‚  {                                                                               â”‚
â”‚    "total_personal_asignado": 14708,                                            â”‚
â”‚    "total_servicio_vivo": 13237.94,                                             â”‚
â”‚    "diferencia_total": 1470.06,                                                 â”‚
â”‚    "cobertura_porcentaje": 90.01,                                               â”‚
â”‚    "total_registros": 5576,                                                     â”‚
â”‚                                                                                  â”‚
â”‚    "by_estado": [                                                                â”‚
â”‚      {"estado": "SOBRECARGA", "count": 2500, "pa": 8000, "sv": 6000},          â”‚
â”‚      {"estado": "FALTA", "count": 1800, "pa": 4500, "sv": 5000},               â”‚
â”‚      ...                                                                        â”‚
â”‚    ],                                                                            â”‚
â”‚                                                                                  â”‚
â”‚    "by_cliente": [                                                               â”‚
â”‚      {                                                                           â”‚
â”‚        "nombre": "SOUTHERN PERU COPPER",                                        â”‚
â”‚        "grupo": "GRUPO MINERO",                                                 â”‚
â”‚        "pa": 484, "sv": 366.69,                                                 â”‚
â”‚        "diferencia": 117.31,                                                    â”‚
â”‚        "cobertura": 131.99,                                                     â”‚
â”‚        "estado": "SOBRECARGA"                                                   â”‚
â”‚      },                                                                          â”‚
â”‚      ...                                                                        â”‚
â”‚    ],                                                                            â”‚
â”‚                                                                                  â”‚
â”‚    "by_zona": [                                                                  â”‚
â”‚      {"zona": "REGION AREQUIPA", "pa": 1100, "sv": 950},                        â”‚
â”‚      {"zona": "ZONA C1", "pa": 800, "sv": 750},                                 â”‚
â”‚      ...                                                                        â”‚
â”‚    ],                                                                            â”‚
â”‚                                                                                  â”‚
â”‚    "filtros_disponibles": {                                                      â”‚
â”‚      "macrozona": ["ZONA CENTRO", "REGION SUR", ...],                          â”‚
â”‚      "zona": ["ZONA C1", "ZONA C2", "REGION AREQUIPA", ...],                   â”‚
â”‚      "compania": ["Liderman Servicios S.A.C.", ...],                           â”‚
â”‚      "grupo": ["GRUPO GLORIA", "GRUPO BRECA", ...],                            â”‚
â”‚      "sector": ["CIUDAD", "MINAS"],                                            â”‚
â”‚      "gerente": ["JOSE PAZOS", "MIGUEL LOYOLA", ...]                           â”‚
â”‚    }                                                                             â”‚
â”‚  }                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Consideraciones de Seguridad por Capa

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SEGURIDAD POR CAPA                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  FRONTEND                    API                       DATABASE
  â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€                       â”€â”€â”€â”€â”€â”€â”€â”€
  
  â€¢ CSRF Token en forms      â€¢ AutenticaciÃ³n Django    â€¢ UUID como PK
  â€¢ ValidaciÃ³n client-side   â€¢ Permisos por Tenant     â€¢ Ãndices optimizados
  â€¢ XSS prevention           â€¢ Rate limiting           â€¢ Queries parametrizadas
  â€¢ Content Security Policy  â€¢ ValidaciÃ³n de archivos  â€¢ Aislamiento por tenant
                             â€¢ CORS configurado        
                             â€¢ Logging de acciones     
```

---

## ğŸ“ˆ Escalabilidad

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CONSIDERACIONES DE ESCALABILIDAD                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ACTUAL (MVP)                          FUTURO (ProducciÃ³n)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  
  â€¢ SQLite                    â†’         â€¢ PostgreSQL
  â€¢ Procesamiento sÃ­ncrono    â†’         â€¢ Celery + Redis (async)
  â€¢ Archivos en disco local   â†’         â€¢ S3 / Azure Blob Storage
  â€¢ Single server             â†’         â€¢ Docker Swarm / Kubernetes
  â€¢ Django dev server         â†’         â€¢ Gunicorn + Nginx
```

---

*Documento generado el 26 de Diciembre de 2025*
